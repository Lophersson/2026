<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Calculadora Hipoteca Dual</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&display=swap');

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Montserrat', Arial, sans-serif;
  font-size: 14px;
  font-weight: 300;
  background: linear-gradient(135deg, #2a2a2a 0%, #2a2a2a 100%);
  color: #888888;
  margin: 0;
  padding: 12px;
  line-height: 1.4;
  min-height: 100vh;
}

header {
  background: linear-gradient(135deg, #4a4a4a, #3a3a3a);
  color: #888888;
  text-align: center;
  padding: 20px 10px;
  border-radius: 12px;
  margin-bottom: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

header h1 {
  font-size: 1.4em;
  letter-spacing: 0.5px;
  font-weight: 400;
  color: #888888;
}

header p {
  font-weight: 300;
  margin-top: 4px;
  font-size: 0.9em;
  opacity: 0.8;
}

main {
  max-width: 750px;
  margin: auto;
  background: #333333;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  border: 1px solid #404040;
}

.mode-toggle {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
  justify-content: center;
}

.mode-toggle button {
  flex: 1;
  max-width: 200px;
  padding: 10px 16px;
  border: 1px solid #4a4a4a;
  border-radius: 8px;
  font-size: 0.9em;
  font-weight: 400;
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'Montserrat', Arial, sans-serif;
  background: #2e2e2e;
  color: #888888;
}

.mode-toggle button.active {
  background: #4a4a4a;
  color: #aaaaaa;
  border-color: #555555;
}

.mode-toggle button:hover:not(.active) {
  background: #3a3a3a;
  border-color: #555555;
}

h2 {
  text-align: center;
  color: #888888;
  font-size: 1.1em;
  font-weight: 400;
  margin: 20px 0 16px;
}

h2::after {
  content: "";
  display: block;
  width: 40px;
  height: 2px;
  background: #555555;
  margin: 6px auto 0;
  border-radius: 2px;
}

.input-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  margin-bottom: 16px;
}

.input-group {
  display: flex;
  flex-direction: column;
}

.input-group.full {
  grid-column: 1 / -1;
}

label {
  color: #888888;
  font-size: 0.85em;
  margin-bottom: 6px;
  font-weight: 400;
}

label small {
  display: block;
  font-size: 0.9em;
  opacity: 0.8;
  margin-top: 2px;
}

input[type="number"] {
  width: 100%;
  padding: 8px 12px;
  font-size: 0.9em;
  border: 1px solid #4a4a4a;
  border-radius: 8px;
  text-align: center;
  transition: 0.3s all ease;
  background: #2e2e2e;
  color: #888888;
  font-family: 'Montserrat', Arial, sans-serif;
}

input[type="number"]:focus {
  border-color: #555555;
  box-shadow: 0 0 4px rgba(85, 85, 85, 0.4);
  outline: none;
}

input[readonly] {
  background: #282828;
  color: #666666;
  cursor: not-allowed;
}

.button-group {
  display: flex;
  gap: 12px;
  margin-top: 16px;
}

button {
  flex: 1;
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  font-size: 0.9em;
  font-weight: 400;
  cursor: pointer;
  transition: all 0.2s;
  font-family: 'Montserrat', Arial, sans-serif;
}

button.primary {
  background: #4a4a4a;
  color: #aaaaaa;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
}

button.primary:hover {
  background: #555555;
  transform: translateY(-1px);
}

button.secondary {
  background: #2e2e2e;
  color: #888888;
  border: 1px solid #4a4a4a;
}

button.secondary:hover {
  background: #3a3a3a;
  border-color: #555555;
}

.resultado {
  background: #2e2e2e;
  border: 1px solid #404040;
  border-radius: 8px;
  padding: 16px;
  margin-top: 16px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

.resultado-destacado {
  background: #3a3a3a;
  border: 1px solid #4a4a4a;
  padding: 20px;
  border-radius: 8px;
  text-align: center;
  margin-bottom: 16px;
}

.resultado-destacado .amount {
  font-size: 2.2em;
  font-weight: 500;
  color: #aaaaaa;
  margin-bottom: 6px;
}

.resultado-destacado .label {
  font-size: 0.85em;
  color: #888888;
  font-weight: 400;
}

.resultado-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  font-weight: 400;
  color: #888888;
  font-size: 0.9em;
  padding: 4px 0;
}

.resultado-item strong {
  color: #888888;
  font-weight: 400;
}

.resultado-item span {
  color: #aaaaaa;
  font-weight: 500;
}

.highlight {
  background: #4a4a4a;
  color: #aaaaaa;
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 500;
}

.divisor {
  height: 1px;
  background: #404040;
  margin: 12px 0;
}

.hidden {
  display: none;
}

.info-note {
  background: #2e2e2e;
  border-left: 3px solid #555555;
  padding: 10px;
  margin-top: 16px;
  border-radius: 4px;
  font-size: 0.85em;
  color: #888888;
  text-align: center;
}

@media (max-width: 600px) {
  body {
    font-size: 13px;
    padding: 8px;
  }

  header h1 {
    font-size: 1.2em;
  }

  header {
    padding: 16px 10px;
  }

  main {
    padding: 16px;
  }

  .input-grid {
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .resultado-item {
    flex-direction: column;
    align-items: center;
    gap: 4px;
  }

  h2 {
    font-size: 1em;
  }

  .resultado-destacado .amount {
    font-size: 1.8em;
  }
}
</style>
</head>
<body>
<header>
<h1>Calculadora Hipotecaria</h1>
<p>Calcula desde precio o desde cuota mensual</p>
</header>

<main>
<div class="mode-toggle">
<button id="modePrice" class="active">Desde Precio</button>
<button id="modeMonthly">Desde Cuota</button>
</div>

<!-- MODO 1: Desde Precio -->
<div id="priceMode">
<h2>Calcular Cuota Mensual</h2>

<div class="input-grid">
<div class="input-group full">
<label for="price">Precio de la vivienda (€)</label>
<input type="number" id="price" value="180000">
</div>

<div class="input-group">
<label for="gp1">% Gastos compraventa</label>
<input type="number" id="gp1" value="10.09" step="0.01">
</div>

<div class="input-group">
<label for="g1">Gastos calculados (€)</label>
<input type="number" id="g1" readonly value="18162">
</div>

<div class="input-group full">
<label for="ap1">Aportación entrada (%)<small>Mínimo 20%</small></label>
<input type="number" id="ap1" value="20" step="0.1">
</div>

<div class="input-group">
<label for="y1">Plazo (años)</label>
<input type="number" id="y1" value="25" step="1">
</div>

<div class="input-group">
<label for="tin1">TIN anual (%)</label>
<input type="number" id="tin1" value="4.20" step="0.01">
</div>
</div>

<div class="button-group">
<button class="primary" id="c1">Calcular</button>
<button class="secondary" id="r1">Restablecer</button>
</div>

<div class="resultado-destacado">
<div class="amount" id="m1">854 €</div>
<div class="label">Cuota mensual</div>
</div>

<div class="resultado">
<div class="resultado-item">
<strong>Precio vivienda:</strong>
<span id="po1">180.000,00 €</span>
</div>
<div class="resultado-item">
<strong>Gastos compraventa:</strong>
<span id="gt1">18.162,00 €</span>
</div>
<div class="resultado-item">
<strong>Precio + gastos:</strong>
<span id="pt1">198.162,00 €</span>
</div>
<div class="divisor"></div>
<div class="resultado-item">
<strong>Entrada (20% mínimo):</strong>
<span class="highlight" id="at1">39.632,40 €</span>
</div>
<div class="resultado-item">
<strong>Importe préstamo (80%):</strong>
<span class="highlight" id="ht1">158.529,60 €</span>
</div>
<div class="divisor"></div>
<div class="resultado-item">
<strong>Plazo:</strong>
<span id="mt1">300 cuotas (25 años)</span>
</div>
<div class="resultado-item">
<strong>TIN anual:</strong>
<span id="tinT1">4,20 %</span>
</div>
<div class="resultado-item">
<strong>Total a pagar:</strong>
<span class="highlight" id="tp1">256.200,00 €</span>
</div>
<div class="resultado-item">
<strong>Intereses totales:</strong>
<span id="it1">97.670,40 €</span>
</div>
</div>

<div class="info-note">* Valores orientativos. No constituyen oferta vinculante.</div>
</div>

<!-- MODO 2: Desde Cuota -->
<div id="monthlyMode" class="hidden">
<h2>Calcular Precio Máximo de Vivienda</h2>

<div class="input-grid">
<div class="input-group full">
<label for="m2in">Cuota mensual que puedes pagar (€)</label>
<input type="number" id="m2in" value="854">
</div>

<div class="input-group">
<label for="gp2">% Gastos compraventa</label>
<input type="number" id="gp2" value="10.09" step="0.01">
</div>

<div class="input-group">
<label for="y2">Plazo (años)</label>
<input type="number" id="y2" value="25" step="1">
</div>

<div class="input-group">
<label for="tin2">TIN anual (%)</label>
<input type="number" id="tin2" value="4.20" step="0.01">
</div>

<div class="input-group">
<label for="ap2">Aportación entrada (%)<small>Mínimo 20%</small></label>
<input type="number" id="ap2" value="20" step="0.1">
</div>
</div>

<div class="button-group">
<button class="primary" id="c2">Calcular</button>
<button class="secondary" id="r2">Restablecer</button>
</div>

<div class="resultado-destacado">
<div class="amount" id="pa2">180.000 €</div>
<div class="label">Precio máximo de vivienda</div>
</div>

<div class="resultado">
<div class="resultado-item">
<strong>Cuota mensual:</strong>
<span id="mt2">854,00 €</span>
</div>
<div class="resultado-item">
<strong>% Gastos compraventa:</strong>
<span id="gpt2">10,09 %</span>
</div>
<div class="resultado-item">
<strong>Gastos calculados:</strong>
<span id="gt2">18.162,00 €</span>
</div>
<div class="resultado-item">
<strong>Precio + gastos:</strong>
<span id="pt2">198.162,00 €</span>
</div>
<div class="divisor"></div>
<div class="resultado-item">
<strong>Entrada (20% mínimo):</strong>
<span class="highlight" id="at2">39.632,40 €</span>
</div>
<div class="resultado-item">
<strong>Importe préstamo (80%):</strong>
<span class="highlight" id="ht2">158.529,60 €</span>
</div>
<div class="divisor"></div>
<div class="resultado-item">
<strong>Plazo:</strong>
<span id="pt2m">300 cuotas (25 años)</span>
</div>
<div class="resultado-item">
<strong>TIN anual:</strong>
<span id="tinT2">4,20 %</span>
</div>
<div class="resultado-item">
<strong>Total a pagar:</strong>
<span class="highlight" id="tp2">256.200,00 €</span>
</div>
<div class="resultado-item">
<strong>Intereses totales:</strong>
<span id="it2">97.670,40 €</span>
</div>
</div>

<div class="info-note">* Valores orientativos. No constituyen oferta vinculante.</div>
</div>

</main>

<script>
const pm=document.getElementById('priceMode'),mm=document.getElementById('monthlyMode');
document.getElementById('modePrice').onclick=()=>{
  pm.classList.remove('hidden');
  mm.classList.add('hidden');
  document.getElementById('modePrice').classList.add('active');
  document.getElementById('modeMonthly').classList.remove('active');
};
document.getElementById('modeMonthly').onclick=()=>{
  mm.classList.remove('hidden');
  pm.classList.add('hidden');
  document.getElementById('modeMonthly').classList.add('active');
  document.getElementById('modePrice').classList.remove('active');
};

function cmp(P,r,y){
  if(P<=0)return 0;
  if(r<=0)return P/(y*12);
  const m=r/100/12,n=y*12;
  return P*m/(1-Math.pow(1+m,-n));
}

function cla(mp,r,y){
  if(mp<=0||y<=0)return 0;
  if(r<=0)return mp*y*12;
  const m=r/100/12,n=y*12;
  return mp*((1-Math.pow(1+m,-n))/m);
}

const pr=document.getElementById('price'),gp1=document.getElementById('gp1'),g1=document.getElementById('g1'),ap1=document.getElementById('ap1'),y1=document.getElementById('y1'),tin1=document.getElementById('tin1');

pr.onchange=()=>{
  const p=Math.max(0,Number(pr.value)||0),gp=Math.max(0,Number(gp1.value)||0);
  g1.value=((gp/100)*p).toFixed(2);
};
gp1.onchange=pr.onchange;
ap1.onchange=()=>{if(Number(ap1.value)<20)ap1.value=20};

document.getElementById('c1').onclick=()=>{
  const p=Math.max(0,Number(pr.value)||0),gp=Math.max(0,Number(gp1.value)||0),g=(gp/100)*p;
  let ap=Math.max(0,Number(ap1.value)||0);
  if(ap<20)ap=20;
  ap1.value=ap;
  const y=Math.max(1,Number(y1.value)||1),tin=Math.max(0,Number(tin1.value)||0);
  g1.value=g.toFixed(2);
  const tc=p+g,e=(ap/100)*tc,h=tc*0.8,cm=cmp(h,tin,y),ms=y*12,tpa=cm*ms,i=tpa-h;
  document.getElementById('m1').innerHTML=Math.round(cm).toLocaleString('es-ES')+' €';
  document.getElementById('tp1').innerHTML=Math.round(tpa).toLocaleString('es-ES')+' €';
  document.getElementById('po1').innerHTML=p.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('gt1').innerHTML=g.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('pt1').innerHTML=tc.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('at1').innerHTML=e.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('ht1').innerHTML=h.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('mt1').innerHTML=ms+' cuotas ('+y+' años)';
  document.getElementById('tinT1').innerHTML=tin.toFixed(2).replace('.',',')+' %';
  document.getElementById('it1').innerHTML=Math.round(i).toLocaleString('es-ES')+' €';
};

document.getElementById('r1').onclick=()=>{
  pr.value=180000;gp1.value=10.09;g1.value=18162;ap1.value=20;y1.value=25;tin1.value=4.20;
  document.getElementById('m1').innerHTML='854 €';
  document.getElementById('c1').click();
};

const m2=document.getElementById('m2in'),gp2=document.getElementById('gp2'),y2=document.getElementById('y2'),tin2=document.getElementById('tin2'),ap2=document.getElementById('ap2');
ap2.onchange=()=>{if(Number(ap2.value)<20)ap2.value=20};

document.getElementById('c2').onclick=()=>{
  const mp=Math.max(0,Number(m2.value)||0),gp=Math.max(0,Number(gp2.value)||0);
  let ap=Math.max(0,Number(ap2.value)||0);
  if(ap<20)ap=20;
  ap2.value=ap;
  const y=Math.max(1,Number(y2.value)||1),tin=Math.max(0,Number(tin2.value)||0),la=cla(mp,tin,y),tc=la/0.8,p=tc/(1+gp/100),g=p*(gp/100),e=tc*0.2,ms=y*12,tpa=mp*ms,i=tpa-la;
  document.getElementById('pa2').innerHTML=Math.round(p).toLocaleString('es-ES')+' €';
  document.getElementById('tp2').innerHTML=Math.round(tpa).toLocaleString('es-ES')+' €';
  document.getElementById('mt2').innerHTML=mp.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('gpt2').innerHTML=gp.toFixed(2).replace('.',',')+' %';
  document.getElementById('gt2').innerHTML=g.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('pt2').innerHTML=tc.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('at2').innerHTML=e.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('ht2').innerHTML=la.toLocaleString('es-ES',{minimumFractionDigits:2})+' €';
  document.getElementById('pt2m').innerHTML=ms+' cuotas ('+y+' años)';
  document.getElementById('tinT2').innerHTML=tin.toFixed(2).replace('.',',')+' %';
  document.getElementById('it2').innerHTML=Math.round(i).toLocaleString('es-ES')+' €';
};

document.getElementById('r2').onclick=()=>{
  m2.value=854;gp2.value=10.09;y2.value=25;tin2.value=4.20;ap2.value=20;
  document.getElementById('pa2').innerHTML='180.000 €';
  document.getElementById('c2').click();
};

document.getElementById('c1').click();
</script>
</body>
</html>
